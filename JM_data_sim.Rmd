---
title: "JM_data_simulation"
author: "James Maze"
date: "2024-11-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
set.seed(42) # If you know, you know ! :)

```

## R Earth Sciences & Biology Distribution


```{r}

params <- list(
  mu = 90000,
  alpha = c('n' = -8000,
            'y' = +15000
  ),
  beta = c('us' = 0,
           'int' = +1000
  )
)
  

earth_bio_hindex_params <- list(
  mu = 9# Doing this later
)

```

```{r}
sample_size <- 1000
gamma_size <- 1000

earth_bio_grads <- data.frame(
  post_doc = rep(NA, sample_size), 
  location = rep(NA, sample_size),
  salary = NA,
  h_index = NA
)

grads <- nrow(earth_bio_grads)

for (r in 1:grads) {
  # randomly assign post-doc or not with proportion (0.3 post-doc, 0.7 not)
  earth_bio_grads$post_doc[r] <- sample(c('y', 'n'), size=1, prob=c(0.3, 0.7))
  # randomly assign location with proportion (0.4 international, 0.6 U.S.)
  earth_bio_grads$location[r] <- sample(c('us', 'int'), size=1, prob=c(0.4, 0.6))
  
  # Assign params 
  pd <- as.character(earth_bio_grads$post_doc[r])
  loc <- as.character(earth_bio_grads$location[r])
  full_mu = params$mu
  alpha = params$alpha[pd]
  beta = params$beta[loc]
  
  sample_mu <- full_mu + alpha + beta
  print(sample_mu)
  
  sample_shape <- 5
  sample_rate <- (sample_shape / sample_mu)
  
  gamma_dist <- rgamma(gamma_size, shape = sample_shape, rate = sample_rate)
  
  if (r %in% c(5, 67, 99, 300, 670, 900)) {
    hist(gamma_dist, breaks = 50, main = paste("Gamma Distribution (Iteration: with", pd, " and", loc,")"),
         xlab = "Value", probability = TRUE, col = "lightgreen")
    lines(density(gamma_dist), col = "blue", lwd = 2)
  }
  
  
  salary <- sample(gamma_dist, size=1)
  print(salary)
  
  earth_bio_grads$salary[r] <- salary
  
}

```

```{r}

h_index_corr <- 0.77


earth_bio_grads <- earth_bio_grads %>% 
  mutate(h_index = ((salary * h_index_corr) + sqrt(1 - h_index_corr * rnorm(n=grads, )


```

```{r}

plot <- ggplot(earth_bio_grads, 
               mapping=aes(x = salary)) +
  geom_histogram(binwidth = 10000, fill = "lightblue", color = "black", alpha = 0.7) +
  labs(title = "Salary Distribution",
       x = "Salary",
       y = "Frequency") +
  theme_minimal() +
  facet_wrap(~location)


```

```{r}

h_index_corr <- 0.77


earth_bio_grads <- earth_bio_grads %>% 
  mutate(h_index = 


```






